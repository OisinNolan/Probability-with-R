---
title: "TP Probabilités"
author: "Piotr Frątczak"
date: "6 05 2020"
output: html_document
---

```{r setup, include=FALSE}

source("generateurs.R")

graine <- 46382
```

## Question 2.1

```{r, echo=TRUE}
k <- 1000

Standard_Minimal <- StandardMinimal(k=k, graine=graine)
RANDU <- randu(k=k, graine=graine)
Von_Neumann <- VonNeumann(n=k, graine=graine)
Mersenne_Twister <- MersenneTwister(n=k, graine=graine)

#par(mfrow=c(1,2)) 
hist(Standard_Minimal)
hist(RANDU)
hist(Von_Neumann)
hist(Mersenne_Twister)
```

## Question 2.2

```{r, echo=TRUE}

plot(Standard_Minimal[1:(k-1)], Standard_Minimal[2:k])
plot(RANDU[1:(k-1)], RANDU[2:k])
plot(Von_Neumann[1:(k-1)], Von_Neumann[2:k])
plot(Mersenne_Twister[1:(k-1)], Mersenne_Twister[2:k])

```


Il n'y a pas de modèle apparent qui relit les valeurs $S_{n-1}$ et $S_n$.
as expented seems to be random


## Question 3

```{r, echo=FALSE}

z <- sample.int(99999,100)

len <- function(vect)
{
  for (i in vect){
    if(i == 1) return(i)
  }
  return(length(vect))
}


Frequency <- function(x, nb)
{
  s <- 0
  totalN <- 0
  
  for (i in x){
    bin <- binary(i)
    for (n in 2:nb) {
      totalN <- totalN + 1
      
      if (bin[n] == 1) s <- s+1
      else             s <- s-1
    }
  }
  
  s_obs <- abs(s) / sqrt(totalN)
  Pvaleur = 2 * (1 - pnorm(s_obs))
  
  return(Pvaleur)
}

seeds <- sample.int(10000, 100)

RANDUavgPvalue <- Frequency(randu(1000, seeds[1]), 32)
for(i in 2:length(seeds)) {
  RANDUavgPvalue <- RANDUavgPvalue + Frequency(randu(1000, seeds[i]), 32)
}
RANDUavgPvalue <- RANDUavgPvalue / 100

SMavgPvalue <- Frequency(randu(1000, seeds[1]), 32)
for(i in 2:length(seeds)) {
  SMavgPvalue <- SMavgPvalue + Frequency(StandardMinimal(1000, seeds[i]), 32)
}
SMavgPvalue <- SMavgPvalue / 100

MTavgPvalue <- Frequency(MersenneTwister(1000, 1, seeds[1]), 32)
for(i in 2:length(seeds)) {
  MTavgPvalue <- MTavgPvalue + Frequency(MersenneTwister(1000, 1, seeds[i]), 32)
}
MTavgPvalue <- MTavgPvalue / 100

```

Algorithm     | Avg. P value
------------- | -------------
RANDU   | `r RANDUavgPvalue`
Standard Minimal | `r SMavgPvalue`
Mersenne Twister | `r MTavgPvalue`

